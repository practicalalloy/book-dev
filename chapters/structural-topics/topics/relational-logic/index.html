<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Arrow multiplicity checks" href="../bestiary/index.html" /><link rel="prev" title="Encoding test instances" href="../testing-instances/index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>A relational logic primer - Practical Alloy</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #2a5adf;
  --color-brand-content: #2a5adf;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">Practical Alloy</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  
  <span class="sidebar-brand-text">Practical Alloy</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about-alloy/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about-book/index.html">About this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../writer-notes.html">Writer notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../structural-modeling/index.html">Structural modeling</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">Structural quick reads</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Structural quick reads</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subset-signatures/index.html">Subset signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nary-relations/index.html">Higher-arity relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enumerations/index.html">Enumeration signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commands in detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../themes/index.html">Visualization customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluator/index.html">The instance evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-instances/index.html">Encoding test instances</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">A relational logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bestiary/index.html">Arrow multiplicity checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ordering/index.html">The predefined <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">ordering</span></code> module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html">Module system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../recursion/index.html">Handling recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integers/index.html">Working with integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../type-system/index.html">Type system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis/index.html">Structural analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../behavioral-modeling/index.html">Behavioral modeling</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../behavioral-topics/index.html">Behavioral quick reads</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Behavioral quick reads</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/mutable-toplevel-signatures/index.html">Mutable top-level signatures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/event-depiction/index.html">An idiom for event depiction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/scenarios/index.html">Encoding trace scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/evaluator/index.html">The trace evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/temporal-logic/index.html">A temporal logic primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/pointwise-effects/index.html">Pointwise effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/fairness/index.html">Safety, Liveness and Fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/sequences/index.html">Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/macros/index.html">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../behavioral-topics/topics/meta/index.html">Meta-capabilities</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../protocol-design/index.html">Protocol design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app-design/index.html">App design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interaction-design/index.html">Interaction design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../system-design/index.html">Controller design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../genindex.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="a-relational-logic-primer">
<h1>A relational logic primer<a class="headerlink" href="#a-relational-logic-primer" title="Link to this heading">#</a></h1>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>&#64;all: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">let</span></code> expressions appear nowhere, introduce here or in the main chapters?</p>
</div>
<p id="index-0">In Alloy, constraints are specified in <em>relational logic</em>, an extension
of first-order logic with a few operators to compose relations. In
this chapter we will present this logic in detail, namely detail the
semantics of each of the operators, illustrated with several usage
examples.</p>
<p>Recall the file system model from the main chapter <a class="reference internal" href="../../../structural-modeling/index.html#structural-modeling"><span class="std std-ref">Structural modeling</span></a>,
and consider the following instance of this specification to illustrate the
result of relational operators throughout the chapter.</p>
<a class="reference internal image-reference" href="../../../../_images/instance125.png"><img alt="../../../../_images/instance125.png" class="align-center" src="../../../../_images/instance125.png" style="width: 500px;" /></a>
<section id="everything-is-a-relation">
<h2>Everything is a relation<a class="headerlink" href="#everything-is-a-relation" title="Link to this heading">#</a></h2>
<p id="index-1">Structures are described in Alloy using only (mathematical)
relations. A <em>relation</em> is a set of tuples of objects drawn from the
universe of discourse. Every tuple in a relation must have the same
size, which is known as the <em>arity</em> of the relation.</p>
<p id="index-2">For example, field <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">name</span></code> is a relation of arity 2 (a <em>binary</em>
relation) relating entries with their names. For the above instance, it has four pairs, namely:</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
</pre></div>
</div>
<p id="index-3">In classical logic a relation is also known as a <em>predicate</em>, and the fact that
predicate <code class="code docutils literal notranslate"><span class="pre">name</span></code> holds for tuple <code class="code docutils literal notranslate"><span class="pre">(x,y)</span></code> is usually denoted
as <code class="code docutils literal notranslate"><span class="pre">name(x,y)</span></code>. As explained later, in Alloy this fact can be
denoted by <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span><span class="o">-&gt;</span><span class="n">y</span> <span class="ow">in</span> <span class="n">name</span></code>.</p>
<p>A set can also be represented by a relation of arity 1. In Alloy,
signatures are encoded in this way. For example, in the above
instance, signature <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Dir</span></code> has the value:</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Dir</span> <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}</span>
</pre></div>
</div>
<p>Moreover, in Alloy even the constants and (quantified) variables are
represented by relations, namely singleton relations of arity 1. A
singleton is a relation with a single tuple. For example, signature
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code>, declared with multiplicity <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">one</span></code>, has the following value.</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Root</span> <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)}</span>
</pre></div>
</div>
<p>Do not confuse the two occurrences of the word <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> in the
above definition. On the left-hand side, we have the signature
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> that was declared in our specification to denote the root of
the file system. On the right-hand side, we have the atom
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> of the universe, whose name was automatically
generated by the Analyzer to populate signature <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code>. The
name of this atom is actually irrelevant, but the Analyzer names
atoms using the signature name as prefix and a sequential number as
suffix. Actually, according to this naming convention, the name of
this atom is <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root0</span></code>, and that is the name that will be
depicted in the evaluator if you ask for the value of signature
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code>. However, in the visualizer, if there is only a single
atom with a given name prefix the numeric suffix is omitted by default. Here we will use the names chosen by the visualizer.</p>
<p>Since atom names are arbitrary, when specifying constraints in
Alloy it is impossible to refer to them directly. If we need to
distinguish a particular atom of the universe, we need to declare a
singleton signature that will contain that atom and refer to that
signature name instead. That was precisely what we did to
distinguish the root of a file system.</p>
<p id="index-4">An <em>instance</em> of an Alloy specification without mutable declarations is a
single <em>snapshot</em> with a complete valuation for all declared signatures
and fields, mapping each of them to a relation of the appropriate
arity. The value of all signatures and fields in
our example instance is the following.</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Object</span>   <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span>
<span class="n">Dir</span>      <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}</span>
<span class="n">Root</span>     <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)}</span>
<span class="n">File</span>     <span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="o">)}</span>
<span class="n">Entry</span>    <span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="n">Name</span>     <span class="o">=</span> <span class="o">{(</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="o">)}</span>

<span class="n">entries</span>  <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="n">object</span>   <span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
<span class="n">name</span>     <span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
</pre></div>
</div>
<p>An instance also includes the values of the three predefined constants: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span></code> (the empty set), <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">univ</span></code> (the universe of all atoms), and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code> (the identity relation on the universe). In our example instance their value is the following.</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="kc">none</span> <span class="o">=</span> <span class="o">{}</span>
<span class="kc">univ</span> <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="o">)}</span>
<span class="kc">iden</span> <span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="p">,</span><span class="n">Name2</span><span class="o">)}</span>
</pre></div>
</div>
</section>
<section id="first-order-logic-in-a-nutshell">
<h2>First-order logic in a nutshell<a class="headerlink" href="#first-order-logic-in-a-nutshell" title="Link to this heading">#</a></h2>
<p id="index-5"><em>Relational logic</em> is an extension of <em>first-order logic</em>, which in
turn is an extension of <em>propositional logic</em>. In propositional logic
the simplest (atomic) formula is a <em>proposition</em> that checks if a
Boolean variable is true. Compound formulas can be built by connecting
atomic formulas using the standard logic connectives (or operators):
negation, conjunction, disjunction, implication, and equivalence. These
connectives are also available in Alloy’s relational logic, and their
syntax is the following.</p>
<div class="table-wrapper docutils container" id="index-6">
<table class="docutils align-default" id="index-6">
<tbody>
<tr class="row-odd"><td><p><strong>Operator</strong></p></td>
<td><p><strong>Name</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">!</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">not</span></code></p></td>
<td><p>Negation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&amp;&amp;</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">and</span></code></p></td>
<td><p>Conjunction</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">||</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">or</span></code></p></td>
<td><p>Disjunction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">=&gt;</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">implies</span></code></p></td>
<td><p>Implication</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&lt;=&gt;</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">iff</span></code></p></td>
<td><p>Equivalence</p></td>
</tr>
</tbody>
</table>
</div>
<p id="index-7">As you can see, Alloy has a dual syntax for these operators, one with
programming language style symbols and the other with English
words. In this book we tend to use the latter, as the resulting
formulas are more readable. The <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">implies</span></code> operator can also
have an optional <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">else</span></code> to state what should be true when the
condition on the left-hand side is false. Given arbitrary formulas
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Q</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">T</span></code>, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span> <span class="ow">implies</span> <span class="n">Q</span> <span class="k">else</span> <span class="n">T</span></code> is the
same as <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">(</span><span class="n">P</span> <span class="ow">and</span> <span class="n">Q</span><span class="o">)</span> <span class="ow">or</span> <span class="o">(</span><span class="ow">not</span> <span class="n">P</span> <span class="ow">and</span> <span class="n">T</span><span class="o">)</span></code>.</p>
<p>In first-order logic we have a domain of discourse (or universe), and
propositions are generalized by predicates that relate elements of
this domain. Formulas can also be built using variables quantified
over this domain. There are two standard quantifiers: the universal
quantifier <code class="code docutils literal notranslate"><span class="pre">∀</span> <span class="pre">x</span> <span class="pre">.</span> <span class="pre">P</span></code> checks if a formula <code class="code docutils literal notranslate"><span class="pre">P</span></code> (possibly
referring to variable <code class="code docutils literal notranslate"><span class="pre">x</span></code>) is true for all <code class="code docutils literal notranslate"><span class="pre">x</span></code> in the
domain; and the existential quantifier <code class="code docutils literal notranslate"><span class="pre">∃</span> <span class="pre">x</span> <span class="pre">.</span> <span class="pre">P</span></code> checks if a
formula <code class="code docutils literal notranslate"><span class="pre">P</span></code> (possibly referring to variable <code class="code docutils literal notranslate"><span class="pre">x</span></code>) is true
for some <code class="code docutils literal notranslate"><span class="pre">x</span></code> in the domain. In Alloy all quantifications are
bounded by a set, and English words are
used instead of the standard mathematical notation. The following
table presents all quantifiers that are available in Alloy: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code>
is denotes an arbitrary set (a unary relation) and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> an arbitrary
formula. The first two are the standard universal and existential
quantifiers.</p>
<div class="table-wrapper docutils container" id="index-8">
<table class="docutils align-default" id="index-8">
<tbody>
<tr class="row-odd"><td><p><strong>Quantifier</strong></p></td>
<td><p><strong>Informal meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is true for all <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> in set <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is true for some <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> in set <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is false for all <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> in set <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">lone</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is true for at most one <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> in set <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">one</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is true for exactly one <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> in set <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>It is well known that the existential quantifier can be specified with
the universal one, and vice-versa, and the same is true for all other
Alloy quantifiers. For example, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code> is the same as
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">not</span> <span class="o">(</span><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="ow">not</span> <span class="n">P</span><span class="o">)</span></code> and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code> is the same
as <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="ow">not</span> <span class="n">P</span></code>.</p>
<p id="index-9">Alloy’s rule that everything is a relation also applies to quantified variables:
the quantified <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code> that can be referred in <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">P</span></code> is a unary relation
containing a single tuple with an atom of the universe. It is also possible to
quantify more than one variable at once, as in <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code> or
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">A</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="n">B</span> <span class="o">|</span> <span class="n">P</span></code>. In the latter, the expression <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">B</span></code> can also
refer to the first quantified variable <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x</span></code>. It is  also possible to add
keyword <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">disj</span></code> to quantify over all different values of the bound
variables. For example, writing <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="k">disj</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">P</span></code> abbreviates
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">:</span> <span class="n">A</span> <span class="o">|</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span> <span class="ow">implies</span> <span class="n">P</span></code>.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>multiple bound variables at once</p></li>
<li><p>translation of lone one no</p></li>
<li><p>difference (or not) between one x,y:A / one x:A,y:A / one x:A|one y:A</p></li>
</ul>
</div>
<p id="index-10">Besides predicates, first-order logic also allows functions as
non-logical symbols. Given some parameters a <em>function</em> returns an
element of the domain. Since in Alloy the atoms of the universe are
mostly uninterpreted there are very few predefined functions. The
exception is when using integers, for which we have the standard arithmetic
operations. If we do not consider functions, atomic formulas in
first-order logic just check for equality of (quantified) variables or
if a tuple of (quantified) variables satisfies (or is a member of) a
predicate.  In Alloy’s relational logic we have a few more atomic
formulas, that are described in the following table, where <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code>
and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">S</span></code> are arbitrary relations of the same arity, including
sets.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Atomic formula</strong></p></td>
<td><p><strong>Informal meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is a subset or equal to <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">S</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="o">=</span> <span class="n">S</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is equal to <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">S</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> contains at least one tuple</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">lone</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> contains at most one tuple</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">one</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> contains exactly one tuple</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is empty</p></td>
</tr>
</tbody>
</table>
</div>
<p>The negation of the subset or equality atomic formulas can also be
written by placing the negation operator next to the comparison
operator. For example, instead of <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">not</span> <span class="o">(</span><span class="n">R</span> <span class="ow">in</span> <span class="n">S</span><span class="o">)</span></code> it is possible
to write <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">S</span></code> or <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="o">!</span><span class="ow">in</span> <span class="n">S</span></code>.</p>
<p>Since quantified variables are also (singleton) relations, although <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">in</span></code>
stands for the ‘subset or equal’ operator (<code class="code docutils literal notranslate"><span class="pre">⊆</span></code>) it can also be used to
check set membership (<code class="code docutils literal notranslate"><span class="pre">∈</span></code>). As we will see below, given
variables <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span></code>, …, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">xₐ</span></code>, it is possible to define
expression <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span></code> that denotes a relation with a single
tuple with those variables. Formula <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span></code> can then
be used to check that this tuple belongs to a relation <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> with
arity <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">a</span></code>, something that in the standard mathematical notation
of first-order logic is written as <code class="code docutils literal notranslate"><span class="pre">R(x₁,…,xₐ)</span></code>. Recall that,
besides equality checks between variables, such membership checks are
the only atomic formulas in first-order logic. Although Alloy also
allows all the above ones, they all can be written using just these
basic checks, so technically they do not add expressive power to
first-order logic, but just a more succinct way to write formulas. The
following table provides such formal definitions, assuming <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code>
and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">S</span></code> have arity <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">a</span></code>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Atomic formula</strong></p></td>
<td><p><strong>Formal meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x₁</span><span class="p">,</span><span class="n">…</span><span class="p">,</span><span class="n">xₐ</span> <span class="p">:</span> <span class="kc">univ</span> <span class="o">|</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">implies</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="o">=</span> <span class="n">S</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="ow">in</span> <span class="n">S</span> <span class="ow">and</span> <span class="n">S</span> <span class="ow">in</span> <span class="n">R</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">x₁</span><span class="p">,</span><span class="n">…</span><span class="p">,</span><span class="n">xₐ</span> <span class="p">:</span> <span class="kc">univ</span> <span class="o">|</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">lone</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x₁</span><span class="p">,</span><span class="n">…</span><span class="p">,</span><span class="n">xₐ</span><span class="p">,</span><span class="n">y₁</span><span class="p">,</span><span class="n">…</span><span class="p">,</span><span class="n">yₐ</span> <span class="p">:</span> <span class="kc">univ</span> <span class="o">|</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">y₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">implies</span> <span class="n">x₁</span><span class="o">=</span><span class="n">y₁</span> <span class="ow">and</span> <span class="n">…</span> <span class="ow">and</span> <span class="n">xₐ</span><span class="o">=</span><span class="n">yₐ</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">one</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">some</span> <span class="n">R</span> <span class="ow">and</span> <span class="k">lone</span> <span class="n">R</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span> <span class="n">R</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">not</span> <span class="o">(</span><span class="k">some</span> <span class="n">R</span><span class="o">)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>As we can see, the reduction in formula size can be substantial. For
example, to formalize the requirement that “every file is an object”,
in plain first-order logic we would have to write <code class="code docutils literal notranslate"><span class="pre">∀</span> <span class="pre">x</span> <span class="pre">.</span> <span class="pre">File(x)</span>
<span class="pre">→</span> <span class="pre">Object(x)</span></code> or, in Alloy’s notation, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="kc">univ</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">File</span>
<span class="ow">implies</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Object</span></code>. However, with Alloy’s relational logic we can
just write <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">File</span> <span class="ow">in</span> <span class="n">Object</span></code>.</p>
<p>It is important to always recall that <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">in</span></code> denotes the subset
operator and not the membership test. Of course, if we are certain
that the expression on the left-hand side is a singleton (a set
with a single tuple), <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="ow">in</span></code> behaves like membership. For
example, to test that <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> is a <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Dir</span></code> we can write
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span> <span class="ow">in</span> <span class="n">Dir</span></code>. However, if the expression on the left-hand
side does not necessarily denote a singleton, this check may not
work as expected. For example, if <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> was declared with
multiplicity <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">lone</span></code> instead of <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">one</span></code>, the check
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span> <span class="ow">in</span> <span class="n">Dir</span></code> will also be true if <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Root</span></code> is empty. In
this case, to be certain to test for membership you also need to
check that the left-hand expression is non-empty, as follows.</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="k">some</span> <span class="n">Root</span> <span class="ow">and</span> <span class="n">Root</span> <span class="ow">in</span> <span class="n">Dir</span>
</pre></div>
</div>
</section>
<section id="relational-operators">
<h2>Relational operators<a class="headerlink" href="#relational-operators" title="Link to this heading">#</a></h2>
<p>As all the alternative atomic checks, most of the relational
operators in Alloy do not technically add expressive power to
first-order logic, but just a more succinct alternative to write
formulas. The full list of operators is presented below.</p>
<div class="table-wrapper docutils container" id="index-11">
<table class="docutils align-default" id="index-11">
<tbody>
<tr class="row-odd"><td><p><strong>Operator</strong></p></td>
<td><p><strong>Name</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">+</span></code></p></td>
<td><p>Union</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&amp;</span></code></p></td>
<td><p>Intersection</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">-</span></code></p></td>
<td><p>Difference</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">.</span></code></p></td>
<td><p>Composition, Dot join</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">[]</span></code></p></td>
<td><p>Box join</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">-&gt;</span></code></p></td>
<td><p>(Cartesian) Product</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&lt;</span><span class="p">:</span></code></p></td>
<td><p>Domain restriction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="p">:</span><span class="o">&gt;</span></code></p></td>
<td><p>Range restriction</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">++</span></code></p></td>
<td><p>Override</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">~</span></code></p></td>
<td><p>Transpose, Converse</p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">^</span></code></p></td>
<td><p>Transitive closure</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">*</span></code></p></td>
<td><p>Reflexive transitive closure</p></td>
</tr>
</tbody>
</table>
</div>
<p>These operators act like combinators, that can be used to put together relations
(predicates) to obtain expressions denoting more complex relations. The
most basic operators are the standard set operators of union,
intersection, and difference. For example, given predicates
<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">File</span></code> and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">Dir</span></code> we can compose them with union to obtain
the derived predicate <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">File</span> <span class="o">+</span> <span class="n">Dir</span></code> that can be used to directly
check if an element is either a file or a directory. This simplifies
the writing of requirements such as (the redundant) “every object is either a file or
a directory”. In plain first-order logic we would write (using Alloy’s syntax):</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">Object</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">File</span> <span class="ow">or</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Dir</span>
</pre></div>
</div>
<p>By using the union operator we can simplify this to:</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="k">all</span> <span class="n">x</span> <span class="p">:</span> <span class="n">Object</span> <span class="o">|</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">File</span> <span class="o">+</span> <span class="n">Dir</span>
</pre></div>
</div>
<p>And finally by using the subset operator we can write just:</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="ow">in</span> <span class="n">File</span> <span class="o">+</span> <span class="n">Dir</span>
</pre></div>
</div>
<p>Below we present the formal semantics of all relational operators in
terms of plain first-order logic. The formula in the right column
formally specifies when a tuple belongs to an expression that uses
each operator. To abbreviate, in this formula all variables are
implicitly universally quantified over the universe. Notice that
some of these operators (namely the transpose and the closure operators)
are only defined for binary relations.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Operator</strong></p></td>
<td><p><strong>Formal meaning</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">+</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">+</span><span class="n">S</span>               <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">or</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&amp;</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">&amp;</span><span class="n">S</span>               <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">-</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">-</span><span class="n">S</span>               <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="o">!</span><span class="ow">in</span> <span class="n">S</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">.</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ₋₁</span><span class="o">-&gt;</span><span class="n">y₂</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₑ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">S</span>  <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">y₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₑ</span> <span class="ow">in</span> <span class="n">S</span> <span class="ow">and</span> <span class="n">xₐ</span> <span class="o">=</span> <span class="n">y₁</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">[]</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">[</span><span class="n">S</span><span class="o">]</span>              <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">R</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">-&gt;</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span><span class="o">-&gt;</span><span class="n">y₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₑ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">-&gt;</span><span class="n">S</span>   <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">y₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₑ</span> <span class="ow">in</span> <span class="n">S</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">&lt;</span><span class="p">:</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">A</span><span class="o">&lt;</span><span class="p">:</span><span class="n">R</span>              <span class="ow">iff</span>  <span class="n">x₁</span> <span class="ow">in</span> <span class="n">A</span> <span class="ow">and</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="p">:</span><span class="o">&gt;</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="p">:</span><span class="o">&gt;</span><span class="n">A</span>              <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">xₐ</span> <span class="ow">in</span> <span class="n">A</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">++</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span><span class="o">++</span><span class="n">S</span>              <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">S</span> <span class="ow">or</span> <span class="o">(</span><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">xₐ</span> <span class="ow">in</span> <span class="n">R</span> <span class="ow">and</span> <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">y₂</span><span class="o">-&gt;</span><span class="n">…</span><span class="o">-&gt;</span><span class="n">yₐ</span> <span class="o">!</span><span class="ow">in</span> <span class="n">S</span><span class="o">)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">~</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">x₂</span> <span class="ow">in</span> <span class="o">~</span><span class="n">R</span>                   <span class="ow">iff</span>  <span class="n">x₂</span><span class="o">-&gt;</span><span class="n">x₁</span> <span class="ow">in</span> <span class="n">R</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">^</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">x₂</span> <span class="ow">in</span> <span class="o">^</span><span class="n">R</span>                   <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">x₂</span> <span class="ow">in</span> <span class="n">R</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">R</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">R</span> <span class="o">+</span> <span class="n">…</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">*</span></code></p></td>
<td><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">x₁</span><span class="o">-&gt;</span><span class="n">x₂</span> <span class="ow">in</span> <span class="o">*</span><span class="n">R</span>                   <span class="ow">iff</span>  <span class="n">x₁</span><span class="o">-&gt;</span><span class="n">x₂</span> <span class="ow">in</span> <span class="o">^</span><span class="n">R</span> <span class="o">+</span> <span class="kc">iden</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Below we illustrate each operator with examples based on the file system
specification presented above.</p>
<section id="composition">
<h3>Composition<a class="headerlink" href="#composition" title="Link to this heading">#</a></h3>
<ul>
<li><p>The entries inside the root</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Root</span><span class="o">.</span><span class="n">entries</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>The names of the entries inside the root</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Root</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">name</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}.</span><span class="n">name</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}.{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>The binary relation between directories and the contained objects</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">entries</span><span class="o">.</span><span class="n">object</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}.{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>Non-empty directories</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">entries</span><span class="o">.</span><span class="n">Entry</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}.{(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="set-operators">
<h3>Set operators<a class="headerlink" href="#set-operators" title="Link to this heading">#</a></h3>
<ul>
<li><p>All directories except the root</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Dir</span> <span class="o">-</span> <span class="n">Root</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}</span> <span class="o">-</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>The directories inside the root</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Root</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span> <span class="o">&amp;</span> <span class="n">Dir</span>
<span class="o">=</span> <span class="n">Root</span><span class="o">.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="n">Dir</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Dir0</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="cartesian-product">
<h3>Cartesian product<a class="headerlink" href="#cartesian-product" title="Link to this heading">#</a></h3>
<ul>
<li><p>All possible associations between files and names</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">File</span><span class="o">-&gt;</span><span class="n">Name</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="o">)}</span> <span class="o">-&gt;</span> <span class="o">{(</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">Name3</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="domain-and-range-restriction">
<h3>Domain and range restriction<a class="headerlink" href="#domain-and-range-restriction" title="Link to this heading">#</a></h3>
<ul>
<li><p>The identity relation on objects</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="o">&lt;</span><span class="p">:</span> <span class="kc">iden</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span> <span class="o">&lt;</span><span class="p">:</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="p">,</span><span class="n">Name2</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">File</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="override">
<h3>Override<a class="headerlink" href="#override" title="Link to this heading">#</a></h3>
<ul>
<li><p>A modified entries relation where all files are removed from the root directory</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">Root</span><span class="o">.</span><span class="n">entries</span> <span class="o">&amp;</span> <span class="n">object</span><span class="o">.</span><span class="n">Dir</span><span class="o">))</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">({(</span><span class="n">Root</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="n">object</span><span class="o">.</span><span class="n">Dir</span><span class="o">))</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">({(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="n">object</span><span class="o">.</span><span class="n">Dir</span><span class="o">))</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">({(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}.{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)}))</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">({(</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="o">)}</span> <span class="o">&amp;</span> <span class="o">{(</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="o">)}))</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">(</span><span class="n">Root</span> <span class="o">-&gt;</span> <span class="o">{(</span><span class="n">Entry2</span><span class="o">)})</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">({(</span><span class="n">Root</span><span class="o">)}</span> <span class="o">-&gt;</span> <span class="o">{(</span><span class="n">Entry2</span><span class="o">)})</span>
<span class="o">=</span> <span class="n">entries</span> <span class="o">++</span> <span class="o">({(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)})</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span> <span class="o">++</span> <span class="o">({(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)})</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Link to this heading">#</a></h3>
<ul>
<li><p>The binary relation between objects (contained in directories) and their name</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="n">object</span><span class="o">.</span><span class="n">name</span>
<span class="o">=</span> <span class="o">~{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}.{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}.{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">File</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>The binary relation between entries in the same directory</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="n">entries</span><span class="o">.</span><span class="n">entries</span>
<span class="o">=</span> <span class="o">~{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>The binary relation between entries sharing names</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="o">.~</span><span class="n">name</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}.~{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Name2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Name1</span><span class="o">)}.{(</span><span class="n">Name0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="closures">
<h3>Closures<a class="headerlink" href="#closures" title="Link to this heading">#</a></h3>
<ul>
<li><p>The binary relation between a directory and the objects contained in that directory or any sub-directory</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="o">^(</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">)</span>
<span class="o">=</span> <span class="o">^{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
<li><p>All objects in the file system</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="n">Root</span><span class="o">.*(</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">)</span>
<span class="o">=</span> <span class="n">Root</span><span class="o">.(^(</span><span class="n">entries</span><span class="o">.</span><span class="n">object</span><span class="o">)</span> <span class="o">+</span> <span class="kc">iden</span><span class="o">)</span>
<span class="o">=</span> <span class="n">Root</span><span class="o">.({(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span> <span class="o">+</span> <span class="kc">iden</span><span class="o">)</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)}.{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry0</span><span class="p">,</span><span class="n">Entry0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry1</span><span class="p">,</span><span class="n">Entry1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry2</span><span class="p">,</span><span class="n">Entry2</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Entry3</span><span class="p">,</span><span class="n">Entry3</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name0</span><span class="p">,</span><span class="n">Name0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name1</span><span class="p">,</span><span class="n">Name1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Name2</span><span class="p">,</span><span class="n">Name2</span><span class="o">)}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir1</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">File</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="set-comprehension">
<h3>Set comprehension<a class="headerlink" href="#set-comprehension" title="Link to this heading">#</a></h3>
<ul>
<li><p>The binary relation between directories and the contained objects</p>
<div class="highlight-electrum notranslate"><div class="highlight"><pre><span></span><span class="o">{</span> <span class="n">d</span> <span class="p">:</span> <span class="n">Dir</span><span class="p">,</span> <span class="n">o</span> <span class="p">:</span> <span class="n">Object</span> <span class="o">|</span> <span class="k">some</span> <span class="n">d</span><span class="o">.</span><span class="n">entries</span> <span class="o">&amp;</span> <span class="n">object</span><span class="o">.</span><span class="n">o</span> <span class="o">}</span>
<span class="o">=</span> <span class="o">{(</span><span class="n">Root</span><span class="p">,</span><span class="n">File</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Root</span><span class="p">,</span><span class="n">Dir0</span><span class="o">)</span><span class="p">,</span><span class="o">(</span><span class="n">Dir0</span><span class="p">,</span><span class="n">Dir1</span><span class="o">)}</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="pre-defined-relational-constants">
<h2>Pre-defined relational constants<a class="headerlink" href="#pre-defined-relational-constants" title="Link to this heading">#</a></h2>
<p>There are three predefined (relational) constants in Alloy:</p>
<ul class="simple">
<li><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span></code>, that denotes the empty set.</p></li>
<li><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">univ</span></code>, the set of all atoms in all signatures.</p></li>
<li><p><code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code>, the binary relation that associates each atom in <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">univ</span></code> to itself.</p></li>
</ul>
<p>It is important to know that <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code> relates every element of <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">univ</span></code> to itself. This means that, for example, to check that a binary relation <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> (defined on a signature <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code>) is reflexive it is not correct to write <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span> <span class="ow">in</span> <span class="n">R</span></code>, as <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code> will not only contain elements in <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code> but also elements in other declared top-level signatures. To obtain the identity relation on signature <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code> we could, for example, intersect it with the binary relation containing all pairs of elements drawn from <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code>, computed with the Cartesian product operator <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">-&gt;</span></code>, as follows: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">A</span> <span class="o">-&gt;</span> <span class="n">A</span><span class="o">)</span></code>. We could also use the domain restriction operator for the same effect: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span> <span class="o">&lt;</span><span class="p">:</span> <span class="kc">iden</span></code> filters relation <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code> to obtain only the pairs whose first element belongs to <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code>. Dually, we could have restricted the range: <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span> <span class="p">:</span><span class="o">&gt;</span> <span class="n">A</span></code> filters relation <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">iden</span></code> to obtain only the pairs whose last element belongs to <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">A</span></code>. Thus, to check that the relation <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is reflexive we could write, for example, <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="o">(</span><span class="n">A</span> <span class="o">&lt;</span><span class="p">:</span> <span class="kc">iden</span><span class="o">)</span> <span class="ow">in</span> <span class="n">R</span></code>.</p>
<p>Another thing to recall is that <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span></code> denotes the empty set and is a unary relation. So, if we write <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="o">=</span> <span class="kc">none</span></code>, to check if <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is empty, we will get a type error since the relations have different arities (<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span></code> is unary and <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is binary). The empty binary relation is denoted by the Cartesian product <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span> <span class="o">-&gt;</span> <span class="kc">none</span></code>: this expression denotes the empty set like <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="kc">none</span></code>, but for the type system it is a binary relation, so writing <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span> <span class="o">=</span> <span class="o">(</span><span class="kc">none</span> <span class="o">-&gt;</span> <span class="kc">none</span><span class="o">)</span></code> does not raise a type error. Of course, a simpler way to check that <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="n">R</span></code> is empty is to write <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span> <span class="n">R</span></code>, since the cardinality check keywords like <code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">no</span></code> can be used with relational expressions of arbitrary arity.</p>
</section>
<section id="alloy-vs-classical-logic-nomenclature">
<span id="nomenclature"></span><h2>Alloy vs. classical logic nomenclature<a class="headerlink" href="#alloy-vs-classical-logic-nomenclature" title="Link to this heading">#</a></h2>
<p id="index-12">Although Alloy is a formal language based on first-order logic, there are some
nuances in the nomenclature that differ from that of traditional logic.</p>
<p>When reasoning about semantics in logic, an <em>instance</em> (or interpretation) of a
formula is usually known as a <em>model</em>: a model of a formula defines a domain (or
universe) of discourse and a valuation of its non-logical symbols that makes the
formula true. In contrast, in Alloy the term <em>model</em> is frequently used to
denote the specification of a system, and the term <em>instance</em> is used to denote
a satisfying universe and valuation. In particular, the Analyzer processes
models (and the commands defined within) and generates instances (when the
problem is satisfiable). This use of the term model in Alloy parlance is
consistent with other techniques and languages for software design, namely the
<a class="reference external" href="https://en.wikipedia.org/wiki/Unified_Modeling_Language">Unified Modeling Language</a>, where a software
model is precisely the kind of artefact we have been denoting by a
specification.</p>
<p>Another concept that has a different meaning in the Alloy language than in
classical logic is that of <em>predicate</em> and <em>function</em>. In first-order logic
(also known as predicate logic), predicates and functions are non-logical
symbols of arbitrary arity for which an interpretation must be provided when
evaluating a formula. Their counter-part in Alloy are the free relations of a
model that arise from the signature and field declarations. In contrast,
<em>predicates</em> (<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">pred</span></code>) and <em>functions</em> (<code class="code highlight alloy electrum docutils literal highlight-electrum"><span class="k">fun</span></code>) in Alloy models are
merely re-usable parametrisable formulas and expressions, respectively, and do
not introduce any new free variables.</p>
<div class="sd-sphinx-override sd-cards-carousel sd-card-cols-1 docutils">
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-header docutils">
<p class="sd-card-text"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-link" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg> Further reading</p>
</div>
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Relations of higher arity</div>
<p class="sd-card-text">Most of these operators can also be applied to higher-arity relations. Learn how to use these in Alloy models.</p>
</div>
<a class="sd-stretched-link reference internal" href="../nary-relations/index.html#nary-relations"><span class="std std-ref"></span></a></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../bestiary/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Arrow multiplicity checks</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../testing-instances/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Encoding test instances</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021-2024, Alcino Cunha, Nuno Macedo, Julien Brunel, David Chemouil
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">A relational logic primer</a><ul>
<li><a class="reference internal" href="#everything-is-a-relation">Everything is a relation</a></li>
<li><a class="reference internal" href="#first-order-logic-in-a-nutshell">First-order logic in a nutshell</a></li>
<li><a class="reference internal" href="#relational-operators">Relational operators</a></li>
<li><a class="reference internal" href="#pre-defined-relational-constants">Pre-defined relational constants</a></li>
<li><a class="reference internal" href="#alloy-vs-classical-logic-nomenclature">Alloy vs. classical logic nomenclature</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js?v=10f1778b"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/design-tabs.js?v=36754332"></script>
    </body>
</html>